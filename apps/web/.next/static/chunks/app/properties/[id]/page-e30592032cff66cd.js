(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[562],{9471:function(e,t,s){Promise.resolve().then(s.bind(s,6664))},6664:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(7573),n=s(7653),a=s(1867),i=s(1695),l=s(8146),d=s(6240);function c(e){let{params:t}=e,s=(0,i.useRouter)(),[c,o]=(0,n.useState)(null),[m,x]=(0,n.useState)([]),[u,g]=(0,n.useState)(!0),[h,p]=(0,n.useState)(""),[b,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{f()},[t.id]);let f=async()=>{let{data:{session:e}}=await a.O.auth.getSession();if(!e){s.push("/login");return}let{data:r,error:n}=await a.O.from("properties").select("*").eq("id",t.id).single();if(n){p("Immobilie nicht gefunden"),g(!1);return}if(r.user_id!==e.user.id){p("Keine Berechtigung"),g(!1);return}o(r);let{data:i,error:l}=await a.O.from("components").select("*").eq("property_id",t.id).eq("is_active",!0).order("next_maintenance",{ascending:!0});x(i||[]),g(!1)},y=async e=>{let t=m.find(t=>t.id===e);if(!t)return;let s=new Date().toISOString().split("T")[0],r=(t.interval_id,12),n=new Date;n.setMonth(n.getMonth()+r);let i=n.toISOString().split("T")[0],{error:l}=await a.O.from("components").update({last_maintenance:s,next_maintenance:i,updated_at:new Date().toISOString()}).eq("id",e);if(l){alert("Fehler: "+l.message);return}j(!0),setTimeout(()=>j(!1),3e3),f()},N=(e,t)=>{let s=new Date,r=new Date(e),n=Math.floor((new Date(t).getTime()-s.getTime())/864e5);return 0===Math.floor((s.getTime()-r.getTime())/864e5)?{color:"green",text:"Gerade erledigt",days:n,status:"completed",justDone:!0,isOverdue:!1}:n<0?{color:"red",text:"\xdcberf\xe4llig",days:Math.abs(n),status:"overdue",justDone:!1,isOverdue:!0}:n<=30?{color:"yellow",text:"Bald f\xe4llig",days:n,status:"soon",justDone:!1,isOverdue:!1}:{color:"green",text:"OK",days:n,status:"ok",justDone:!1,isOverdue:!1}};return u?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"L\xe4dt..."})]})}):h||!c?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Fehler"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:h||"Immobilie nicht gefunden"}),(0,r.jsx)(l.default,{href:"/dashboard",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"← Zur\xfcck zum Dashboard"})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[b&&(0,r.jsx)("div",{className:"fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg animate-bounce z-50",children:"✅ Wartung erfolgreich aktualisiert!"}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)(l.default,{href:"/dashboard",className:"text-indigo-600 hover:text-indigo-800 font-medium mb-4 inline-block",children:"← Zur\xfcck zum Dashboard"}),(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:c.name}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Erstellt am ",new Date(c.created_at).toLocaleDateString("de-AT")]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(l.default,{href:"/properties/".concat(c.id,"/edit"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors",children:"✏️ Bearbeiten"}),(0,r.jsx)(d.Z,{propertyId:c.id,propertyName:c.name})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[c.status&&(0,r.jsx)("div",{className:"px-6 py-3 ".concat("rented"===c.status?"bg-green-50 border-b border-green-200":"bg-yellow-50 border-b border-yellow-200"),children:(0,r.jsx)("p",{className:"text-sm font-medium ".concat("rented"===c.status?"text-green-800":"text-yellow-800"),children:"rented"===c.status?"✅ Vermietet":"⏳ Verf\xfcgbar"})}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Adresse"]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-gray-900",children:c.address}),(0,r.jsxs)("p",{className:"text-gray-600",children:[c.postal_code," ",c.city]}),(0,r.jsx)("p",{className:"text-gray-600",children:c.country})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center",children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Details"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Immobilientyp"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:{house:"\uD83C\uDFE1 Einfamilienhaus",apartment:"\uD83C\uDFE2 Wohnung",multi_family:"\uD83C\uDFD8️ Mehrfamilienhaus",commercial:"\uD83C\uDFED Gewerbeobjekt"}[c.property_type]||c.property_type})]}),c.build_year&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Baujahr"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:c.build_year})]}),c.living_area&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Wohnfl\xe4che"}),(0,r.jsxs)("p",{className:"text-lg font-medium text-gray-900",children:[c.living_area," m\xb2"]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Letzte Aktualisierung"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:new Date(c.updated_at).toLocaleDateString("de-AT")})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900 mb-3 flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Wartungen (",m.length,")"]}),(0,r.jsx)(l.default,{href:"/properties/".concat(c.id,"/maintenance/new"),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors text-sm",children:"+ Hinzuf\xfcgen"})]}),0===m.length?(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Noch keine Wartungen angelegt"}),(0,r.jsx)(l.default,{href:"/properties/".concat(c.id,"/maintenance/new"),className:"inline-block px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-colors",children:"\uD83D\uDD27 Erste Wartung hinzuf\xfcgen"})]}):(0,r.jsx)("div",{className:"space-y-3",children:m.map(e=>{let t=N(e.last_maintenance,e.next_maintenance);return(0,r.jsx)("div",{className:"border-l-4 rounded-lg p-4 ".concat(t.justDone?"bg-green-50 border-green-500":"overdue"===t.status?"bg-red-50 border-red-500":"soon"===t.status?"bg-yellow-50 border-yellow-500":"bg-green-50 border-green-500"),children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:e.custom_name||({HEAT_GAS_001:"Gastherme",HEAT_OIL_001:"\xd6lheizung",HEAT_PELLET_001:"Pelletsheizung"})[e.interval_id]||"Wartung"}),(0,r.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded font-medium",children:"⚖️ Gesetzlich"}),t.justDone&&(0,r.jsx)("span",{className:"text-xs px-2 py-1 bg-green-600 text-white rounded font-medium animate-pulse",children:"✓ Heute erledigt!"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Heizung • Regelm\xe4\xdfige Wartung erforderlich"}),(e.brand||e.model)&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-2",children:[e.brand," ",e.model]}),(0,r.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["Letzte: ",(0,r.jsx)("strong",{children:new Date(e.last_maintenance).toLocaleDateString("de-AT")})]}),(0,r.jsxs)("span",{className:"font-medium ".concat(t.justDone?"text-green-700":"overdue"===t.status?"text-red-700":"soon"===t.status?"text-yellow-700":"text-green-700"),children:["N\xe4chste: ",(0,r.jsx)("strong",{children:new Date(e.next_maintenance).toLocaleDateString("de-AT")}),"overdue"===t.status&&!t.justDone&&(0,r.jsxs)("span",{className:"ml-2",children:["(",t.days," Tage \xfcberf\xe4llig!)"]}),"soon"===t.status&&(0,r.jsxs)("span",{className:"ml-2",children:["(in ",t.days," Tagen)"]}),"ok"===t.status&&!t.justDone&&(0,r.jsxs)("span",{className:"ml-2",children:["(in ",t.days," Tagen)"]}),t.justDone&&(0,r.jsxs)("span",{className:"ml-2",children:["(N\xe4chste in ",t.days," Tagen)"]})]})]})]}),(0,r.jsx)("div",{className:"ml-4",children:t.isOverdue||t.justDone?t.justDone?(0,r.jsx)("button",{disabled:!0,className:"px-3 py-1 rounded font-medium text-sm bg-green-600 text-white cursor-not-allowed opacity-75",children:"✓ Erledigt"}):(0,r.jsx)("button",{onClick:()=>y(e.id),className:"px-3 py-1 rounded font-medium text-sm bg-red-600 hover:bg-red-700 text-white",children:"✓ Erledigt"}):(0,r.jsx)("button",{disabled:!0,className:"px-3 py-1 rounded font-medium text-sm bg-gray-300 text-gray-500 cursor-not-allowed",children:"✓ Aktuell"})})]})},e.id)})})]})]})]})]})]})}},6240:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(7573),n=s(7653),a=s(1867),i=s(1695);function l(e){let{propertyId:t,propertyName:s}=e,l=(0,i.useRouter)(),[d,c]=(0,n.useState)(!1),[o,m]=(0,n.useState)(!1),x=async()=>{m(!0);let{error:e}=await a.O.from("properties").delete().eq("id",t);if(e){alert("Fehler beim L\xf6schen: "+e.message),m(!1),c(!1);return}window.location.href="/dashboard",l.refresh()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>c(!0),className:"px-4 py-2 border border-red-600 text-red-600 rounded-lg font-medium hover:bg-red-50 transition",children:"\uD83D\uDDD1️ L\xf6schen"}),d&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("span",{className:"text-3xl",children:"⚠️"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 text-center mb-4",children:"Immobilie wirklich l\xf6schen?"}),(0,r.jsx)("p",{className:"text-center mb-4 text-gray-700",children:(0,r.jsx)("strong",{children:s})}),(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[(0,r.jsx)("p",{className:"text-sm text-red-800 mb-2 font-bold",children:"⚠️ Diese Aktion kann NICHT r\xfcckg\xe4ngig gemacht werden!"}),(0,r.jsxs)("ul",{className:"text-sm text-red-700 space-y-1",children:[(0,r.jsx)("li",{children:"• Alle Wartungen werden gel\xf6scht"}),(0,r.jsx)("li",{children:"• Alle Dokumente werden gel\xf6scht"}),(0,r.jsx)("li",{children:"• Der Wartungsverlauf geht verloren"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{onClick:()=>c(!1),disabled:o,className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg font-bold text-gray-700 hover:bg-gray-50 transition disabled:opacity-50",children:"Abbrechen"}),(0,r.jsx)("button",{onClick:x,disabled:o,className:"flex-1 px-6 py-3 bg-red-600 text-white rounded-lg font-bold hover:bg-red-700 transition disabled:opacity-50",children:o?"Wird gel\xf6scht...":"Ja, endg\xfcltig l\xf6schen"})]})]})})]})}},1867:function(e,t,s){"use strict";s.d(t,{O:function(){return r}});let r=(0,s(2978).eI)("https://cfggqkjogprlzikzxijc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNmZ2dxa2pvZ3BybHppa3p4aWpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MzQzMDksImV4cCI6MjA3NjIxMDMwOX0.gyIVDXpqTWpZjKzE1qmI-ObeIb0D6pIoZPfwu3gtzpk")}},function(e){e.O(0,[978,738,293,528,744],function(){return e(e.s=9471)}),_N_E=e.O()}]);